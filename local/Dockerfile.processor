FROM ultralytics/ultralytics:latest@sha256:6bff428cd62fd6efab8a4d6a9c7cdfa4f79a10778574840e036fc2e858ea52d9

ENV PYTHONUNBUFFERED=1
WORKDIR /app

# Install processor package
COPY app/processor/ .
RUN pip install --no-cache-dir -e .

# Install tooling for tests, linting, formatting, etc.
COPY local/requirements.dev.txt /tmp/requirements.dev.txt
RUN pip install --no-cache-dir -r /tmp/requirements.dev.txt

CMD ["python3", "-u", "processor/app.py"]
